<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BudgetFlow - Smart Finance</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar container">
        <div class="brand-wrapper">
            <button class="private-budget-trigger" id="privateBudgetBtn" title="Private Budget">
                <i data-lucide="wallet" class="brand-icon"></i>
            </button>
            <div class="brand">
                <span class="brand-name">BudgetFlow</span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero-section container">
        <div class="hero-content">
            <h1 class="hero-title" id="heroTitle">
                Manage Your Family Finances with <span class="gradient-text">Clarity.</span>
            </h1>
            <p class="hero-subtext" id="heroSubtext">
                Track income, expenses, and savings for every family member in one beautiful dashboard. Simple, secure,
                and smart.
            </p>
            <a href="#trackerApp" class="btn btn-cta">
                Start Tracking <i data-lucide="arrow-right" class="icon-sm"></i>
            </a>
        </div>
    </header>

    <!-- Feature Cards -->
    <section class="features-section container">
        <div class="feature-card">
            <div class="icon-container icon-blue">
                <i data-lucide="users"></i>
            </div>
            <h3>Multi-Member Budgeting</h3>
            <p>Separate tracking for Mom, Dad, and Kids with instant switching.</p>
        </div>
        <div class="feature-card">
            <div class="icon-container icon-green">
                <i data-lucide="pie-chart"></i>
            </div>
            <h3>Smart Analysis</h3>
            <p>Visual breakdown of income streams and spending habits.</p>
        </div>
        <div class="feature-card">
            <div class="icon-container icon-purple">
                <i data-lucide="trending-up"></i>
            </div>
            <h3>Income-Based Insights</h3>
            <p>Group expenses automatically by their funding source.</p>
        </div>
        <div class="feature-card">
            <div class="icon-container icon-orange">
                <i data-lucide="history"></i>
            </div>
            <h3>Full History</h3>
            <p>Searchable transaction logs with monthly filtering.</p>
        </div>
    </section>

    <!-- Main App Interface -->
    <div id="trackerApp" class="app-container container">

        <div class="section-title-wrapper">
            <h2>Your Dashboard</h2>
            <p>Overview of current financial status</p>
        </div>


        <!-- Family Member Selector -->
        <section class="member-selector-section">
            <div class="card member-selector-card">
                <div class="member-selector-header">
                    <h3><i data-lucide="user-check" class="icon-inline"></i> Family Member</h3>
                    <p class="member-subtitle">Select a profile to manage</p>
                </div>
                <div class="member-selector-controls">
                    <div class="form-group">
                        <label for="memberSelect">Select Profile</label>
                        <div class="select-wrapper">
                            <select id="memberSelect" class="modern-select">
                                <option value="default">All Members (Default)</option>
                                <option value="mom">Mom</option>
                                <option value="dad">Dad</option>
                                <option value="sister">Sister</option>
                                <option value="brother">Brother</option>
                                <option value="grandma">Grandma</option>
                                <option value="grandpa">Grandpa</option>
                                <option value="other">Other (Custom Name)</option>
                            </select>
                            <i data-lucide="chevron-down" class="select-icon"></i>
                        </div>
                    </div>
                    <div class="form-group" id="customMemberGroup" style="display: none;">
                        <label for="customMemberName">Custom Name</label>
                        <div class="custom-member-input-group">
                            <input type="text" id="customMemberName" placeholder="e.g. Vacation Fund" maxlength="30">
                            <button class="btn btn-primary" id="addCustomMemberBtn">Add Profile</button>
                        </div>
                    </div>
                </div>
                <div class="current-member-display">
                    <span class="current-member-label">Active Profile:</span>
                    <span class="current-member-name" id="currentMemberDisplay">All Members (Default)</span>
                </div>
            </div>
        </section>

        <!-- Dashboard Cards -->
        <section class="dashboard">
            <div class="card balance-card">
                <div class="card-header">
                    <h3>Current Balance</h3>
                    <i data-lucide="wallet" class="card-icon"></i>
                </div>
                <p class="amount" id="balance">₹0.00</p>
            </div>
            <div class="card income-card">
                <div class="card-header">
                    <h3>Total Income</h3>
                    <i data-lucide="arrow-down-circle" class="card-icon"></i>
                </div>
                <p class="amount income-text" id="totalIncome">₹0.00</p>
            </div>
            <div class="card expense-card">
                <div class="card-header">
                    <h3>Total Expense</h3>
                    <i data-lucide="arrow-up-circle" class="card-icon"></i>
                </div>
                <p class="amount expense-text" id="totalExpense">₹0.00</p>
            </div>
        </section>

        <!-- Month Selector -->
        <section class="month-selector">
            <div class="filter-group">
                <label for="monthFilter"><i data-lucide="calendar" class="icon-inline"></i> Filter by Month</label>
                <input type="month" id="monthFilter" />
            </div>
            <div class="filter-actions">
                <button class="btn btn-secondary" id="clearFilter">Show All</button>
                <button class="btn btn-info" id="toggleAnalysisBtn" onclick="toggleIncomeAnalysisView()">
                    <i data-lucide="bar-chart-2" class="icon-inline"></i> View Income Groups
                </button>
            </div>
        </section>

        <!-- Income Analysis Section (Hidden by default) -->
        <section id="incomeAnalysis" class="income-analysis-section" style="display: none;">
            <div class="card analysis-card">
                <div class="card-header-internal">
                    <h2>Income Analysis</h2>
                    <span class="badge badge-info">Smart Grouping</span>
                </div>
                <div id="analysisContainer">
                    <!-- Dynamic Content -->
                </div>
            </div>
        </section>

        <!-- Add Transaction & History Grid -->
        <div class="app-grid">
            <!-- Add Transaction Form -->
            <section class="form-section">
                <div class="card form-card">
                    <div class="card-header-internal">
                        <h2>New Transaction</h2>
                    </div>
                    <form id="transactionForm">
                        <div class="form-group">
                            <label for="amount">Amount (₹)</label>
                            <input type="number" id="amount" step="0.01" min="0.01" placeholder="0.00" required>
                        </div>

                        <div class="form-group">
                            <label for="type">Type</label>
                            <div class="select-wrapper">
                                <select id="type" required class="modern-select">
                                    <option value="">Select Type</option>
                                    <option value="income">Income</option>
                                    <option value="expense">Expense</option>
                                </select>
                                <i data-lucide="chevron-down" class="select-icon"></i>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="reason">Description</label>
                            <input type="text" id="reason" placeholder="e.g., Salary, Groceries" required>
                        </div>

                        <div class="form-group">
                            <label for="date">Date</label>
                            <input type="date" id="date" required>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block">Add Transaction</button>
                    </form>
                </div>
            </section>

            <!-- Transaction History -->
            <section class="history-section" id="historySection">
                <div class="card history-card">
                    <div class="card-header-internal">
                        <h2>Recent History</h2>
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="empty-state">
                        <div class="empty-icon-container">
                            <i data-lucide="clipboard-list"></i>
                        </div>
                        <p>No transactions yet.</p>
                        <span>Add your first income or expense to get started!</span>
                    </div>

                    <!-- Transaction Table -->
                    <div id="tableContainer" class="table-container" style="display: none;">
                        <table id="transactionTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="transactionBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- PIN Modal for Private Budget -->
    <div id="pinModal" class="modal modal-overlay" style="display: none;">
        <div class="modal-content pin-modal">
            <button id="closePinModal" class="modal-close">
                <i data-lucide="x" class="icon-sm"></i>
            </button>
            <div class="modal-header">
                <h2 id="pinModalTitle">Set Up Private Budget PIN</h2>
                <p id="pinModalMessage">Create a 6-digit PIN to secure your private budget</p>
            </div>

            <!-- Error Message -->
            <div id="pinError" class="pin-error"
                style="display: none; color: #ef4444; margin-bottom: 1rem; text-align: center;"></div>

            <!-- PIN Input -->
            <div class="pin-input-group">
                <label for="pin1">Enter PIN</label>
                <div class="pin-inputs">
                    <input type="text" id="pin1" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pin2" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pin3" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pin4" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pin5" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pin6" class="pin-input" maxlength="1" inputmode="numeric" />
                </div>
            </div>

            <!-- PIN Confirmation (only shown when setting new PIN) -->
            <div id="pinConfirmContainer" class="pin-input-group" style="display: none;">
                <label for="pinConfirm1">Confirm PIN</label>
                <div class="pin-inputs">
                    <input type="text" id="pinConfirm1" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pinConfirm2" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pinConfirm3" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pinConfirm4" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pinConfirm5" class="pin-input" maxlength="1" inputmode="numeric" />
                    <input type="text" id="pinConfirm6" class="pin-input" maxlength="1" inputmode="numeric" />
                </div>
            </div>

            <!-- Modal Actions -->
            <div class="modal-actions">
                <button id="cancelPinBtn" class="btn btn-secondary">Cancel</button>
                <button id="submitPinBtn" class="btn btn-primary">Submit</button>
            </div>
        </div>
    </div>

    <!-- Initialize Lucide Icons -->
    <script>
        window.addEventListener('load', function () {
            if (window.lucide) {
                lucide.createIcons();
            }
        });
    </script>
    <script src="script.js"></script>
</body>

</html>